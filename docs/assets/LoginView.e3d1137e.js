import{c as R,d as G,w as I,o as H,aq as A,b as l,l as U,q as J,P as K,y as V,n as F,ar as Q,x as L,B as W,L as X,as as Y,D as k,C as Z,E as $,at as ee,f as C,au as oe,_ as ne,U as te,T as ae,r as se,a as ie,R as h,F as T,G as le,M as B,a2 as w,av as re,aw as ce,ao as ue,a3 as z,a5 as q}from"./index.e00a4050.js";/* empty css              */import{m as de,u as fe}from"./mount-component.8d6fb4a8.js";let _=0;function me(e){e?(_||document.body.classList.add("van-toast--unclickable"),_++):_&&(_--,_||document.body.classList.remove("van-toast--unclickable"))}const[ve,b]=R("toast"),pe=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay"],ye={icon:String,show:Boolean,type:V("text"),overlay:Boolean,message:F,iconSize:F,duration:Q(2e3),position:V("middle"),teleport:[String,Object],className:L,iconPrefix:String,transition:V("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:L,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean};var D=G({name:ve,props:ye,emits:["update:show"],setup(e,{emit:n}){let t,o=!1;const u=()=>{const a=e.show&&e.forbidClick;o!==a&&(o=a,me(o))},d=a=>n("update:show",a),g=()=>{e.closeOnClick&&d(!1)},i=()=>clearTimeout(t),v=()=>{const{icon:a,type:s,iconSize:p,iconPrefix:P,loadingType:N}=e;if(a||s==="success"||s==="fail")return l(W,{name:a||s,size:p,class:b("icon"),classPrefix:P},null);if(s==="loading")return l(X,{class:b("loading"),size:p,type:N},null)},f=()=>{const{type:a,message:s}=e;if(Y(s)&&s!=="")return a==="html"?l("div",{key:0,class:b("text"),innerHTML:String(s)},null):l("div",{class:b("text")},[s])};return I(()=>[e.show,e.forbidClick],u),I(()=>[e.show,e.type,e.message,e.duration],()=>{i(),e.show&&e.duration>0&&(t=setTimeout(()=>{d(!1)},e.duration))}),H(u),A(u),()=>l(K,U({class:[b([e.position,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:g,onClosed:i,"onUpdate:show":d},J(e,pe)),{default:()=>[v(),f()]})}});const j={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let c=[],x=!1,S=k({},j);const O=new Map;function E(e){return ee(e)?e:{message:e}}function ge(){const{instance:e,unmount:n}=de({setup(){const t=C(""),{open:o,state:u,close:d,toggle:g}=fe(),i=()=>{x&&(c=c.filter(f=>f!==e),n())},v=()=>l(D,U(u,{onClosed:i,"onUpdate:show":g}),null);return I(t,f=>{u.message=f}),oe().render=v,{open:o,clear:d,message:t}}});return e}function he(){if(!c.length||x){const e=ge();c.push(e)}return c[c.length-1]}function r(e={}){if(!Z)return{};const n=he(),t=E(e);return n.open(k({},S,O.get(t.type||S.type),t)),n}const M=e=>n=>r(k({type:e},E(n)));r.loading=M("loading");r.success=M("success");r.fail=M("fail");r.clear=e=>{var n;c.length&&(e?(c.forEach(t=>{t.clear()}),c=[]):x?(n=c.shift())==null||n.clear():c[0].clear())};function _e(e,n){typeof e=="string"?O.set(e,n):k(S,e)}r.setDefaultOptions=_e;r.resetDefaultOptions=e=>{typeof e=="string"?O.delete(e):(S=k({},j),O.clear())};r.allowMultiple=(e=!0)=>{x=e};r.install=e=>{e.use($(D)),e.config.globalProperties.$toast=r};const be={setup(e){const n=te(),t=ae(),o=C(!1),u=C(!1),d=C(!1),g=C(1e3*60),i=se({phoneNumber:null,verifyCode:null}),v=ie(()=>!!(o.value&&u.value));function f(m){const y=/^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$/;return y.test(m)?o.value=!0:o.value=!1,y.test(m)}function a(m){const y=/^\d{6}$/;return u.value=y.test(m),y.test(m)}async function s(){await re({url:"/gateway",mobile:i.phoneNumber,type:"1"}),d.value=!0}function p(){d.value=!1}async function P(m){const y=await ce({url:"/gateway",mobile:i.phoneNumber,smsCode:`${i.verifyCode}`});y.msg=="ok"?(n.push({path:t.query.fromPath}),ue.updateUserInfo("\u672A\u77E5\u540D\u826F\u597D\u5E02\u6C11")):r({icon:"none",message:y.msg})}function N(m){m.errors&&r.fail({icon:"none",message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u9A8C\u8BC1\u7801"})}return{form:i,isPhCorrect:o,showTime:d,canSubmit:v,time:g,onSubmit:P,onFailed:N,checkPhoneNumber:f,checkVerifyCode:a,onTimeFinish:p,sendSMS:s}}},Ce={class:"login-view"},ke={class:"icon-box"},we={class:"number-box"},Se=q("\u83B7\u53D6\u9A8C\u8BC1\u7801"),Oe={style:{margin:"16px"}},xe=q(" \u63D0\u4EA4 ");function Pe(e,n,t,o,u,d){const g=h("van-icon"),i=h("van-field"),v=h("van-button"),f=h("van-count-down"),a=h("van-cell-group"),s=h("van-form");return T(),le("div",Ce,[B("div",ke,[l(g,{"class-prefix":"myicon",name:"bussinessman",size:"30",class:"icon"})]),l(s,{onSubmit:o.onSubmit,"validate-trigger":"onChange",onFailed:o.onFailed},{default:w(()=>[l(a,null,{default:w(()=>[B("div",we,[l(i,{modelValue:o.form.phoneNumber,"onUpdate:modelValue":n[0]||(n[0]=p=>o.form.phoneNumber=p),name:"phoneNumber",label:"\u624B\u673A\u53F7\u7801",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801",autocomplete:"off",rules:[{required:!0,validator:o.checkPhoneNumber}]},null,8,["modelValue","rules"]),o.showTime?(T(),z(f,{key:1,time:o.time,format:"ss \u79D2",class:"counter",onFinish:o.onTimeFinish},null,8,["time","onFinish"])):(T(),z(v,{key:0,type:"primary",size:"small",disabled:!o.isPhCorrect,onClick:o.sendSMS},{default:w(()=>[Se]),_:1},8,["disabled","onClick"]))]),l(i,{modelValue:o.form.verifyCode,"onUpdate:modelValue":n[1]||(n[1]=p=>o.form.verifyCode=p),name:"verifyCode",label:"\u9A8C\u8BC1\u7801",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",autocomplete:"off",rules:[{required:!0,validator:o.checkVerifyCode}]},null,8,["modelValue","rules"])]),_:1}),B("div",Oe,[l(v,{round:"",block:"",type:"primary","native-type":"submit",disabled:!o.canSubmit},{default:w(()=>[xe]),_:1},8,["disabled"])])]),_:1},8,["onSubmit","onFailed"])])}var Be=ne(be,[["render",Pe],["__scopeId","data-v-0964a70e"]]);export{Be as default};
