import{C as E}from"./CinemaList.57a265d1.js";import{_ as x,R as r,F as l,a3 as C,a2 as k,a9 as L,a as N,f as g,aa as R,ab as H,ac as P,ad as j,U as z,T as A,r as U,ae as h,af as S,G as F,b as p,$ as W,M as q,J as G,K as J,a0 as K,N as M}from"./index.f793904c.js";import{c as v,g as T,f as Q,d as X}from"./getCinemaList.88ed5cf0.js";/* empty css              */const Y={};function Z(a,u){const c=r("van-dropdown-menu");return l(),C(c,{"active-color":"#FF4040"},{default:k(()=>[L(a.$slots,"default")]),_:3})}var $=x(Y,[["render",Z]]);const tt={props:{refName:String,modelValue:Number,currentDistrictId:String|Number,districts:{type:Object,default:()=>{}},options:{type:Array,default:()=>[]},change:{type:Function,default:function(){}}},emits:["chooseDistrict"],setup(a,{expose:u,emit:c}){const t=a,s=N(()=>t.currentDistrictId&&t.districts?t.districts[t.currentDistrictId]||"\u5168\u57CE":""),y=g(null);u({cityDropEle:y});function m(e){c("chooseDistrict",e)}return(e,n)=>{const d=r("van-dropdown-item");return l(),C(d,{ref:a.refName,modelValue:a.modelValue,"onUpdate:modelValue":n[0]||(n[0]=i=>R(modelValue)?modelValue.value=i:null),title:H(s),options:a.options,onChange:a.change},{default:k(()=>[L(e.$slots,"default",{districts:a.districts,chooseDistrict:m,currentDistrictId:a.currentDistrictId})]),_:3},8,["modelValue","title","options","onChange"])}}};const et={components:{CinemaList:E,NavBar:P,FilterBar:$,FilterBarItem:tt},setup(a){const u=j("tabbarHeight"),c=z(),t=A(),s=U({data:[]}),y=[{text:"APP\u8BA2\u7968",value:1},{text:"\u524D\u53F0\u8BA2\u7968",value:2}],m=[{text:"\u79BB\u6211\u6700\u8FD1",value:1},{text:"\u6700\u8FD1\u53BB\u8FC7",value:2}],e=g(1),n=g(1),d=g(null),i=g(null),f=N(()=>i.value==h.city.id?v[e.value]:v[e.value]&&v[e.value].filter(o=>o.district.districtId==i.value));S(()=>{f.value&&f.value.length&&(s.data=f.value)}),S(()=>{h.city.id&&(i.value=h.city.id)}),D();async function D(){v[e.value]?Q(e.value):await T({cityId:h.city.id,ticketFlag:e.value})}function b(o){o.target.dataset.districtid!=i.value&&(i.value=o.target.dataset.districtid,d.value.cityDropEle.toggle(!1))}function V(o){e.value=o,D()}function _(o){n.value=o,n.value===1?s.data.sort((w,I)=>w.Distance-I.Distance):s.data.sort((w,I)=>I.Distance-w.Distance)}function O(){c.push({path:"/city",query:{fromPath:t.path,ticketFlag:e.value}})}function B(){c.push({path:"/searchCinema"})}return{store:h,cinemas:v,districts:X,tabbarHeight:u,cityDrop:d,dynamicList:s,currentDistrictId:i,ticketOptions:y,likeOptions:m,ticketFlag:e,likeFlag:n,chooseDistrict:b,bookWayChange:V,likeChange:_,toCityView:O,toSearchView:B}}},at={class:"cinema-view"},it=["onClickCapture"],nt=["data-districtId"];function ot(a,u,c,t,s,y){const m=r("nav-bar"),e=r("filter-bar-item"),n=r("filter-bar"),d=r("cinema-list"),i=r("my-loading");return l(),F("div",at,[p(m,{isShowSearch:!0,onOnClickLeft:t.toCityView,onOnSearch:t.toSearchView},null,8,["onOnClickLeft","onOnSearch"]),p(n,null,{default:k(()=>[p(e,{ref:"cityDrop",refName:"cityDrop",districts:t.districts.data,currentDistrictId:t.currentDistrictId,onChooseDistrict:t.chooseDistrict},{default:k(({districts:f,chooseDistrict:D,currentDistrictId:b})=>[q("ul",{class:"city-options",onClickCapture:D},[(l(!0),F(G,null,J(f,(V,_)=>(l(),F("li",{class:K(["option-item",{active:_==b}]),key:_,"data-districtId":_},M(V),11,nt))),128))],40,it)]),_:1},8,["districts","currentDistrictId","onChooseDistrict"]),p(e,{options:t.ticketOptions,modelValue:t.ticketFlag,change:t.bookWayChange},null,8,["options","modelValue","change"]),p(e,{options:t.likeOptions,modelValue:t.likeFlag,change:t.likeChange},null,8,["options","modelValue","change"])]),_:1}),t.cinemas[t.ticketFlag]?(l(),C(d,{key:0,style:W({marginBottom:`${t.tabbarHeight}px`}),cinemaList:t.dynamicList.data},null,8,["style","cinemaList"])):(l(),C(i,{key:1,position:"absolute"}))])}var dt=x(et,[["render",ot],["__scopeId","data-v-dcb4e76c"]]);export{dt as default};
